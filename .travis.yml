---
language: python
python:
  - 3.6
  - 3.7
  - 3.8

matrix:
  include:
    - python: 3.7
      env: TOXENV=py37
    - python: 3.7
      env: TOXENV=py37-ansible29

before_install:
  # yamllint disable rule:line-length

  # .. seealso:: https://github.com/junaruga/podman-experiment/blob/master/.travis.yml
  # .. seealso:: https://travis-ci.community/t/podman-libpod-support/6823/6

  # https://github.com/containers/libpod/blob/master/install.md#ubuntu
  - sudo apt-get update -qq
  - sudo apt-get install -qq -y software-properties-common uidmap
  - sudo add-apt-repository -y ppa:projectatomic/ppa
  - sudo apt-get update -qq
  - sudo apt-get -qq -y install podman

  # Show version and info.
  - podman --version
  - podman version
  - podman info --debug
  - apt-cache show podman
  - dpkg-query -L podman

  # Hack podman's configuration files.
  # /etc/containers/registries.conf does not exist.
  # https://clouding.io/kb/en/how-to-install-and-use-podman-on-ubuntu-18-04/
  - ls -1 /etc/containers/registries.conf || true
  - sudo mkdir -p /etc/containers
  - echo -e "[registries.search]\nregistries = ['docker.io', 'quay.io']" | sudo tee /etc/containers/registries.conf

  # yamllint enable rule:line-length

  - sudo apt-get -qq update
  - sudo apt-get install -y bash iproute2 iputils-ping

install:
  - pip install tox-travis

script:
  - tox

# vim:sw=2:ts=2:et:
